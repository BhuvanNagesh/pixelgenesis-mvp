<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Token ‚Äî PixelGenesis</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="particles">
        <div class="particle" style="left: 8%;"></div>
        <div class="particle" style="left: 25%;"></div>
        <div class="particle" style="left: 45%;"></div>
        <div class="particle" style="left: 65%;"></div>
        <div class="particle" style="left: 85%;"></div>
    </div>

    <div class="container" style="max-width: 750px;">
        <h2>üé´ Generate Access Token</h2>
        <p class="subtitle">Create privacy-preserving zero-knowledge tokens</p>

        {% if error %}
            <div class="error">‚úó {{ error }}</div>
        {% endif %}

        <div class="tabs">
            <div class="tab active" onclick="switchMode('value')">Mode A: Selective Disclosure</div>
            <div class="tab" onclick="switchMode('predicate')">Mode B: Predicate Proof</div>
            <div class="tab" onclick="switchMode('file')">Mode C: File Upload</div>
        </div>

        <form method="POST" enctype="multipart/form-data" id="tokenForm">
            <input type="hidden" name="mode" id="mode_input" value="value">

            <div id="value_block" class="tab-content active">
                <label for="field">Select Attribute</label>
                <select name="field" id="field">
                    <option value="name">Name</option>
                    <option value="dob">Date of Birth</option>
                    <option value="gender">Gender</option>
                    <option value="aadhaar_hash">Aadhaar Hash</option>
                </select>
                <p style="color: var(--mint-glow); margin-top: 12px; font-size: 0.95rem;">
                    üìå Only the selected attribute will be shared. Other data remains private.
                </p>

                <div style="text-align: center; margin: 30px 0;">
                    <div class="chip" id="selected-chip">Attribute: Name</div>
                </div>
            </div>

            <div id="predicate_block" class="tab-content">
                <label for="pred_field">Field Name</label>
                <input type="text" name="pred_field" id="pred_field" placeholder="e.g., age, gender" value="age">

                <label for="op">Condition</label>
                <select name="op" id="op">
                    <option value="gt">Greater Than (&gt;)</option>
                    <option value="ge">Greater or Equal (‚â•)</option>
                    <option value="eq">Equal (=)</option>
                    <option value="in">Contains (‚àà)</option>
                </select>

                <label for="pred_value">Comparison Value</label>
                <input type="text" name="pred_value" id="pred_value" placeholder="e.g., 18, male, blr" value="18">

                <div style="background: rgba(31, 169, 115, 0.15); border: 1px dashed var(--neon-green); border-radius: 10px; padding: 20px; margin-top: 30px; text-align: center;">
                    <p style="font-size: 1.1rem; color: var(--mint-glow); margin-bottom: 10px;">
                        üîê Zero-Knowledge Predicate
                    </p>
                    <p style="color: var(--white); font-size: 0.95rem;">
                        Verify statements without revealing raw data
                    </p>
                    <div style="margin-top: 15px; padding: 12px; background: rgba(10, 30, 23, 0.6); border-radius: 8px; font-family: 'Courier New', monospace; color: var(--neon-green);">
                        Prove: age &gt; 18 ‚Üí TRUE/FALSE
                    </div>
                </div>
            </div>

            <div id="file_block" class="tab-content">
                <label for="file">Choose File</label>
                <input type="file" name="file" id="file">

                <div style="background: rgba(15, 62, 46, 0.3); border: 1px solid var(--glass-border); border-radius: 12px; padding: 20px; margin-top: 24px;">
                    <label style="display: flex; align-items: center; cursor: pointer; margin: 0;">
                        <input type="checkbox" name="encrypt" style="margin-right: 12px;">
                        <span style="font-size: 1.1rem;">üîê Encrypt file with AES-256 + Shamir Secret Sharing (2-of-3)</span>
                    </label>
                    <p style="color: var(--mint-glow); margin-top: 12px; font-size: 0.9rem; margin-left: 30px;">
                        File will be encrypted before upload. Decryption requires 2 out of 3 secret shards.
                    </p>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <div style="width: 140px; height: 140px; margin: 0 auto; background: rgba(31, 169, 115, 0.1); border-radius: 50%; border: 2px dashed var(--neon-green); display: flex; align-items: center; justify-content: center; flex-direction: column; font-size: 2.5rem;">
                        üóÇÔ∏è
                        <span style="font-size: 0.9rem; margin-top: 8px; color: var(--mint-glow);">Encrypted Upload</span>
                    </div>
                </div>
            </div>

            <div style="margin-top: 30px; padding-top: 30px; border-top: 1px solid rgba(31, 169, 115, 0.3);">
                <label for="ttl_seconds">Token Expiry (seconds)</label>
                <input type="number" name="ttl_seconds" id="ttl_seconds" placeholder="300 (default)" value="">
                <p style="color: var(--mint-glow); margin-top: 8px; font-size: 0.9rem;">
                    Leave empty for 300s default. Set to 0 for no expiration.
                </p>
            </div>

            <button type="submit"><span>‚ö° Generate Token</span></button>
            <a href="/" class="btn" style="background: rgba(15, 62, 46, 0.5); border-color: rgba(31, 169, 115, 0.5);"><span>‚Üê Back to Home</span></a>
        </form>
    </div>

    <script>
        function switchMode(mode) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(mode + '_block').classList.add('active');
            document.getElementById('mode_input').value = mode;
        }

        document.getElementById('field').addEventListener('change', function() {
            const chip = document.getElementById('selected-chip');
            chip.textContent = 'Attribute: ' + this.options[this.selectedIndex].text;
        });
    </script>
</body>
</html>
