<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Token Management ‚Äî PixelGenesis</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="particles">
        <div class="particle" style="left: 11%;"></div>
        <div class="particle" style="left: 29%;"></div>
        <div class="particle" style="left: 47%;"></div>
        <div class="particle" style="left: 66%;"></div>
        <div class="particle" style="left: 84%;"></div>
    </div>

    <div class="container" style="max-width: 1200px;">
        <h2>üìä Token Management Dashboard</h2>
        <p class="subtitle">View and manage all access tokens</p>

        {% if message == 'revoked' %}
            <div class="success">‚úì Token revoked successfully</div>
        {% elif message == 'not_found' %}
            <div class="error">‚úó Token not found</div>
        {% endif %}

        <table>
            <thead>
                <tr>
                    <th>Token</th>
                    <th>Mode</th>
                    <th>Field</th>
                    <th>Value</th>
                    <th>Issued</th>
                    <th>Expiry</th>
                    <th>Remaining</th>
                    <th>Status</th>
                    <th>Revoked At</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for t in tokens %}
                    <tr>
                        <td style="font-family: 'Courier New', monospace; font-size: 0.8rem; max-width: 120px; overflow: hidden; text-overflow: ellipsis;">{{ t.token }}</td>
                        <td>
                            {% if t.mode == 'value' %}
                                <span style="background: linear-gradient(135deg, var(--neon-green), var(--deep-green)); padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">VALUE</span>
                            {% elif t.mode == 'predicate' %}
                                <span style="background: linear-gradient(135deg, #ff8f00, #ff6f00); padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">PREDICATE</span>
                            {% elif t.mode == 'file' %}
                                <span style="background: linear-gradient(135deg, #3949ab, #1e88e5); padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">FILE</span>
                            {% endif %}
                        </td>
                        <td>{{ t.field }}</td>
                        <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">{{ t.value }}</td>
                        <td style="font-size: 0.85rem;">{{ t.issued }}</td>
                        <td style="font-size: 0.85rem;">{{ t.expiry }}</td>
                        <td>
                            {% if t.remaining == "Expired" %}
                                <span style="color: #ef4444; font-weight: 700;">Expired</span>
                            {% elif t.remaining == "Never" %}
                                <span style="color: var(--mint-glow); font-weight: 700;">Never</span>
                            {% else %}
                                <span style="color: var(--neon-green); font-weight: 700;">{{ t.remaining }}</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if t.revoked %}
                                <span style="background: #ef4444; padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">REVOKED</span>
                            {% else %}
                                <span style="background: var(--neon-green); color: var(--dark-bg); padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">ACTIVE</span>
                            {% endif %}
                        </td>
                        <td style="font-size: 0.85rem;">{{ t.revoked_at }}</td>
                        <td>
                            {% if not t.revoked %}
                                <form method="POST" action="/revoke_token" style="margin: 0;">
                                    <input type="hidden" name="token" value="{{ t.token }}">
                                    <button type="submit" class="revoke-btn"><span>Revoke</span></button>
                                </form>
                            {% else %}
                                <span style="color: var(--mint-glow); opacity: 0.5;">‚Äî</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <a href="/" class="btn" style="margin-top: 40px;"><span>‚Üê Back to Home</span></a>
    </div>
</body>
</html>
